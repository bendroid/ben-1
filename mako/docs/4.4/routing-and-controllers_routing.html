


<!--<!DOCTYPE html>-->
<html>
	
<!-- Mirrored from makoframework.com/docs/4.4/routing-and-controllers:routing by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 02 Aug 2015 15:42:32 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>

		<title>Documentation - 4.4 - Mako Framework</title>

		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<link rel="shortcut icon" href="../../assets/img/favicon.ico">
		<link type="text/css" rel="stylesheet" href="../../assets/css/materialize.min.css"  media="screen,projection"/>
		<link type="text/css" rel="stylesheet" href="../../assets/css/font-awesome.min.css"  media="screen,projection"/>
		<link type="text/css" rel="stylesheet" href="../../assets/css/animate.css"  media="screen,projection"/>
		<link type="text/css" rel="stylesheet" href="../../assets/css/mako.css"  media="screen,projection"/>
		<link type="text/css" rel="stylesheet" href="../../assets/css/backtotop.css"  media="screen,projection"/>
		<link type="text/css" rel="stylesheet" href="../../assets/css/prism.css"  media="screen,projection"/>

		<script>
			var mako = {'base_url': 'http://makoframework.com/'};
		</script>

		<script>
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-19891169-1']);
		_gaq.push(['_setDomainName', '.makoframework.com']);
		_gaq.push(['_trackPageview']);
		(function()
		{
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
		</script>

	</head>

	<body>

		<ul id="source-dropdown" class="dropdown-content nav-dropdown">
			<li><a href="../../contributing/contributors.html">Contributors</a></li>
			<li><a href="https://github.com/mako-framework">View on GitHub</a></li>
		</ul>

		<nav id="nav" class="grey darken-3-5">
			<div class="container">
				<div class="nav-wrapper">
					<a href="../../index.html" class="brand-logo"><img src="../../assets/img/logo50.png" alt="Mako"></a>
					<ul id="nav-mobile" class="right side-nav">
						<li><a href="../4.html">Documentation</a></li>
						<li><a href="http://api.makoframework.com/">API</a></li>
						<li>
							<a class="dropdown-button" href="#!" data-activates="source-dropdown">Source<i class="mdi-navigation-arrow-drop-down right"></i></a>
						</li>
						<li><a href="https://github.com/mako-framework/framework/issues">Issues</a></li>
						<li><a href="http://forum.makoframework.com/">Community</a></li>
						<li><a href="#!" id="toggle-search"><i class="large mdi-action-search"></i></a></li>
					</ul>
					<a class="button-collapse" href="#" data-activates="nav-mobile"><i class="mdi-navigation-menu"></i></a>
				</div>
			</div>
		</nav>

		<div class="row white-text grey darken-3" id="search">

			<div class="container">
				<form action="https://www.google.com/search" method="get">
					<input class="form-control" type="text" name="q" placeholder="Search ...">
					<input type="hidden" name="as_sitesearch" value="makoframework.com">
				</form>
			</div>

		</div>

		<div id="content">

			
		<div class="row white z-depth-1" id="tab-wrapper">
			<div class="container">
				<div class="row tabs">
											<div class="col s12 m3 "><p><a href="../4.html">4.5</a></p></div>
											<div class="col s12 m3 active"><p><a href="../4-2.html">4.4</a></p></div>
											<div class="col s12 m3 "><p><a href="../4-3.html">4.3</a></p></div>
										<div class="col s12 m3 ">
						<select id="legacy-docs">
							<option value="" disabled selected>Older</option>
															<option value="http://makoframework.com/docs/4.2">4.2</option>
															<option value="http://makoframework.com/docs/4.1">4.1</option>
															<option value="http://makoframework.com/docs/4.0">4.0</option>
															<option value="http://makoframework.com/docs/3.6">3.6</option>
													</select>
					</div>
				</div>
			</div>
		</div>



			
	<div class="container">

		<button class="grey lighten-2 waves-effect waves-light btn-flat" type="submit" name="action" id="toggle-menu">Open Menu</button>

		<div class="row content">
			<div class="col l3 m12 s12 left-menu">

				<div id="left-nav">
				
					
							<div class="menu-header">Getting started</div>

							<div class="menu-items">

								
									<p>
										<a  href="getting-started_installation.html">
											Installation										</a>
									</p>

								
									<p>
										<a  href="getting-started_configuration.html">
											Configuration										</a>
									</p>

								
									<p>
										<a  href="getting-started_dependency-injection.html">
											Dependency injection										</a>
									</p>

								
									<p>
										<a  href="getting-started_error-handling.html">
											Error handling										</a>
									</p>

								
									<p>
										<a  href="getting-started_constants.html">
											Constants										</a>
									</p>

								
									<p>
										<a  href="getting-started_coding-standards.html">
											Coding standards										</a>
									</p>

								
									<p>
										<a  href="getting-started_upgrading.html">
											Upgrading										</a>
									</p>

								
							</div>

					
							<div class="menu-header">Routing and controllers</div>

							<div class="menu-items">

								
									<p>
										<a  class="active" href="routing-and-controllers_routing.html">
											Routing										</a>
									</p>

								
									<p>
										<a  href="routing-and-controllers_controllers.html">
											Controllers										</a>
									</p>

								
									<p>
										<a  href="routing-and-controllers_request.html">
											Request										</a>
									</p>

								
									<p>
										<a  href="routing-and-controllers_response.html">
											Response										</a>
									</p>

								
							</div>

					
							<div class="menu-header">Command line</div>

							<div class="menu-items">

								
									<p>
										<a  href="command-line_basics.html">
											Basics										</a>
									</p>

								
									<p>
										<a  href="command-line_custom-commands.html">
											Custom commands										</a>
									</p>

								
							</div>

					
							<div class="menu-header">Databases (SQL)</div>

							<div class="menu-items">

								
									<p>
										<a  href="databases-sql_basics.html">
											Basics										</a>
									</p>

								
									<p>
										<a  href="databases-sql_query-builder.html">
											Query builder										</a>
									</p>

								
									<p>
										<a  href="databases-sql_orm.html">
											Orm										</a>
									</p>

								
									<p>
										<a  href="databases-sql_migrations.html">
											Migrations										</a>
									</p>

								
							</div>

					
							<div class="menu-header">Databases (NoSQL)</div>

							<div class="menu-items">

								
									<p>
										<a  href="databases-nosql_redis.html">
											Redis										</a>
									</p>

								
							</div>

					
							<div class="menu-header">Security</div>

							<div class="menu-items">

								
									<p>
										<a  href="security_authentication.html">
											Authentication										</a>
									</p>

								
									<p>
										<a  href="security_password-hashing.html">
											Password hashing										</a>
									</p>

								
									<p>
										<a  href="security_encryption-and-signing.html">
											Encryption and signing										</a>
									</p>

								
							</div>

					
							<div class="menu-header">Packages</div>

							<div class="menu-items">

								
									<p>
										<a  href="packages_packages.html">
											Packages										</a>
									</p>

								
							</div>

					
							<div class="menu-header">Learn more</div>

							<div class="menu-items">

								
									<p>
										<a  href="learn-more_array-helper.html">
											Array helper										</a>
									</p>

								
									<p>
										<a  href="learn-more_caching.html">
											Caching										</a>
									</p>

								
									<p>
										<a  href="learn-more_date-and-time.html">
											Date and time										</a>
									</p>

								
									<p>
										<a  href="learn-more_events.html">
											Events										</a>
									</p>

								
									<p>
										<a  href="learn-more_file-system.html">
											File system										</a>
									</p>

								
									<p>
										<a  href="learn-more_html-helper.html">
											Html helper										</a>
									</p>

								
									<p>
										<a  href="learn-more_humanizer.html">
											Humanizer										</a>
									</p>

								
									<p>
										<a  href="learn-more_image-manipulation.html">
											Image manipulation										</a>
									</p>

								
									<p>
										<a  href="learn-more_internationalization.html">
											Internationalization										</a>
									</p>

								
									<p>
										<a  href="learn-more_logging.html">
											Logging										</a>
									</p>

								
									<p>
										<a  href="learn-more_number-helper.html">
											Number helper										</a>
									</p>

								
									<p>
										<a  href="learn-more_pagination.html">
											Pagination										</a>
									</p>

								
									<p>
										<a  href="learn-more_sessions.html">
											Sessions										</a>
									</p>

								
									<p>
										<a  href="learn-more_string-helper.html">
											String helper										</a>
									</p>

								
									<p>
										<a  href="learn-more_url-builder.html">
											Url builder										</a>
									</p>

								
									<p>
										<a  href="learn-more_uuid-helper.html">
											Uuid helper										</a>
									</p>

								
									<p>
										<a  href="learn-more_validation.html">
											Validation										</a>
									</p>

								
									<p>
										<a  href="learn-more_views.html">
											Views										</a>
									</p>

								
							</div>

									</div>

			</div>
			<div class="col l9 m12 s12">
				<div class="page-content">
					<h1>Routing</h1>

<hr />

<ul>
<li><a href="#basics">Basics</a></li>
<li><a href="#route_parameters">Route parameters</a></li>
<li><a href="#route_filters">Route filters</a>

<ul>
<li><a href="#route_filters:defining_filters">Defining filters</a></li>
<li><a href="#route_filters:assigning_filters">Assigning filters</a></li>
</ul></li>
<li><a href="#route_groups">Route groups</a></li>
<li><a href="#reverse_routing">Reverse routing</a></li>
<li><a href="#faking_request_methods">Faking request methods</a></li>
</ul>

<hr />

<p>The Mako router lets you map URL patterns to class methods and closures. It also allows you to perform reverse routing so that you don't have to hardcode URLs in your application.</p>

<p>Routes are registered in the <code>app/routing/routes.php</code> file and there are three variables avaiable in the scope, <code>$routes</code> (the route collection) and <code>$app</code> (the application instance) and <code>$container</code> (the IoC container instance).</p>

<hr />

<p><a id="basics"></a></p>

<h3>Basics</h3>

<p>The following route will forward all <code>GET</code> requests to the <code>/</code> route to the <code>welcome</code> method of the <code>app\controllers\Home</code>controller class.</p>

<pre><code>$routes-&gt;get('/', 'app\controllers\Home::welcome');
</code></pre>

<p>If you want the route to respond to <code>POST</code> requests instead then you'll have to use the <code>post</code> method.</p>

<pre><code>$routes-&gt;post('/', 'app\controllers\Home::welcome');
</code></pre>

<p>The available methods are <code>get</code>, <code>post</code>, <code>put</code>, <code>patch</code>, and <code>delete</code>.</p>

<p>You can also make a route respond to all request methods using the <code>all</code> method.</p>

<pre><code>$routes-&gt;all('/', 'app\controllers\Home::welcome');
</code></pre>

<blockquote>
  <p>All routes will by default respond to requests made using the <code>OPTIONS</code> method. <code>GET</code> routes will also respond to <code>HEAD</code> requests.</p>
</blockquote>

<p>If you only want to allow a specific set of methods then you can use the <code>methods</code> method.</p>

<pre><code>$routes-&gt;methods(['GET', 'POST'], '/', 'app\controllers\Home::welcome');
</code></pre>

<p>Routes can also execute closures instead of class methods.</p>

<pre><code>$routes-&gt;get('/hello-world', function()
{
    return 'Hello, world!';
});
</code></pre>

<hr />

<p><a id="route_parameters"></a></p>

<h3>Route parameters</h3>

<p>You'll often want to send parameters to your route actions. This is easy and can be done like this.</p>

<pre><code>$routes-&gt;get('/articles/{id}', function($id)
{
    return $id;
});
</code></pre>

<p>If you need to make a parameter optional then you can do so by adding the <code>?</code> suffix.</p>

<pre><code>$routes-&gt;get('/articles/{id}/{slug}?', function($id, $slug = null)
{
    return $id . ' ' . $slug;
});
</code></pre>

<p>You can also impose constraints on your parameters using the <code>when</code> method. The route will not be matched unless all constraints are satisfied.</p>

<pre><code>$routes-&gt;get('/articles/{id}', function($id)
{
    return 'article ' . $id;
})
-&gt;when(['id' =&gt; '[0-9]+']);
</code></pre>

<p>Closure actions get executed by the <code>Container::call()</code> method so all dependecies are automatically <a href="getting-started_dependency-injection.html">injected</a>.</p>

<pre><code>$routes-&gt;get('/article/{id}', function(ViewFactory $view, $id)
{
    return $view-&gt;render('article', ['id' =&gt; $id]);
})
-&gt;when(['id' =&gt; '[0-9]+']);
</code></pre>

<hr />

<p><a id="route_filters"></a></p>

<h3>Route filters</h3>

<p><a id="route_filters:defining_filters"></a></p>

<h4>Defining filters</h4>

<p>You can define filters that will get executed before and after your route actions.</p>

<p>Filters are registered in the <code>app/routing/filters.php</code> file. There are three variables avaiable in the scope, <code>$filters</code> (the filter collection) and <code>$app</code> (the application instance) and <code>$container</code> (the IoC container instance).</p>

<p>Closure filters get executed by the <code>Container::call()</code> method so all dependecies are automatically <a href="getting-started_dependency-injection.html">injected</a>.</p>

<p>The route filters (both class filters and closures) are executed using the <code>Container::call()</code> method. This means that you typehint dependencies just like you can with route actions.</p>

<blockquote>
  <p>Note that a route action and its after filters will <strong>not</strong> be executed if a before filter returns data.</p>
</blockquote>

<p>This filter will return cached version of route response if it's available.</p>

<pre><code>$filters-&gt;register('cache.get', function(Request $request, CacheManager $cache)
{
    if($cache-&gt;has('route.' . $request-&gt;path()))
    {
        return $cache-&gt;get('route.' . $request-&gt;path());
    }
});
</code></pre>

<p>This filter will cache route responses for 10 minutes:</p>

<pre><code>$filters-&gt;register('cache.put', function(Request $request, Response $response, CacheManager $cache, $minutes = 10)
{
    $cache-&gt;put('route.' . $request-&gt;path(), $response-&gt;getBody(), 60 * $minutes);
});
</code></pre>

<blockquote>
  <p>The cache example above is very basic and should probably not be used in a production environment.</p>
</blockquote>

<p>You can also create a filter classes instead of closures. The class will be instantiated through the <a href="getting-started_dependency-injection.html">dependency injection container</a> so you can easily inject your dependencies through the constructor.</p>

<pre><code>namespace app\routing\filters;

use mako\http\Request;
use mako\http\Response;

class MyFilter
{
    public function construct(Request $request, Response $response)
    {
        $this-&gt;request = $request;

        $this-&gt;response = $response;
    }

    public function filter()
    {
        // Do your filtering here
    }
}
</code></pre>

<p>Registering a filter class is just as easy as registering a closure.</p>

<pre><code>$filters-&gt;register('my_filter', 'app\routing\filters\MyFilter');
</code></pre>

<p><a id="route_filters:assigning_filters"></a></p>

<h4>Assigning filters</h4>

<p>Assigning filters to a route is done using the <code>before</code> and <code>after</code> methods. You can also pass an array of filters if your route has multiple filters. The filters get executed in the order that they are assigned.</p>

<pre><code>$routes-&gt;get('/articles/{id}', 'app\controllers\Articles::view')
-&gt;when(['id' =&gt; '[0-9]+'])
-&gt;before('cache.read')
-&gt;after('cache.write');
</code></pre>

<p>You can also pass parameters to your filters. In the example below we're telling the filter to cache the response for 60 minutes instead of the default 10.</p>

<pre><code>$routes-&gt;get('/articles/{id}', 'app\controllers\Articles::view')
-&gt;when(['id' =&gt; '[0-9]+'])
-&gt;before('cache.read')
-&gt;after('cache.write:{"minutes":60}');
</code></pre>

<blockquote>
  <p>Anything after the first colon symbol (<code>:</code>) will be parsed as JSON. In the example above we're telling the dispatcher that the value <code>60</code> should be passed to the <code>$minutes</code> parameter of the filter.</p>
</blockquote>

<hr />

<p><a id="route_groups"></a></p>

<h3>Route groups</h3>

<p>Route groups are usefull when you have a set of groups with the same constraints and filters.</p>

<pre><code>$options = 
[

    'before'    =&gt; 'cache.read', 
    'after'     =&gt; 'cache.write', 
    'when'      =&gt; ['id' =&gt; '[0-9]+'],
    'namespace' =&gt; 'app\controllers',
];

$routes-&gt;group($options, function($routes)
{
    $routes-&gt;get('/articles/{id}', 'Articles::view');

    $routes-&gt;get('/photos/{id}', 'Photos::view');
});
</code></pre>

<p>All routes within the group will now have the same filters and constraints. You can also nest groups if needed.</p>

<p>The following options are available when creating a route group. They are also available as chainable methods on individual routes.</p>

<table class="bordered striped">
<thead>
<tr>
  <th>Option</th>
  <th>Method</th>
  <th>Description</th>
</tr>
</thead>
<tbody>
<tr>
  <td>before</td>
  <td>before</td>
  <td>A before filter or an array of before filters</td>
</tr>
<tr>
  <td>after</td>
  <td>after</td>
  <td>An after filter or an array of aflter filters</td>
</tr>
<tr>
  <td>when</td>
  <td>when</td>
  <td>An array of parameter constraints</td>
</tr>
<tr>
  <td>prefix</td>
  <td>prefix</td>
  <td>Route prefix</td>
</tr>
<tr>
  <td>namespace</td>
  <td>setNamespace</td>
  <td>The controller namespace (closures will not be affected)</td>
</tr>
</tbody>
</table>

<hr />

<p><a id="reverse_routing"></a></p>

<h3>Reverse routing</h3>

<p>You can assign names to your routes when you define them. This will allow you to perform reverse routing, thus removing the need of hardcoding URLs in your views.</p>

<pre><code>$routes-&gt;get('/', 'Home::Welcome', 'home');
</code></pre>

<p>The route in the example above has been named <code>home</code> and we can now create a URL to the route using the <code>toRoute</code> method of the <code>URLBuilder</code> class.</p>

<pre><code>&lt;a href="{{$urlBuilder-&gt;toRoute('home')}}"&gt;Home&lt;/a&gt;
</code></pre>

<p>You can also pass parameters to your route URLs.</p>

<pre><code>&lt;a href="{{$urlBuilder-&gt;toRoute('articles.view', ['id' =&gt; 1])"&gt;Article&lt;/a&gt;
</code></pre>

<hr />

<p><a id="faking_request_methods"></a></p>

<h3>Faking request methods</h3>

<p>Most browsers only support sending <code>GET</code> and <code>POST</code> requests. You can get around this limitation by performing a <code>POST</code> request including a <code>REQUEST_METHOD_OVERRIDE</code> field where you specify the request method you want to use.</p>

<pre><code>&lt;input type="hidden" name="REQUEST_METHOD_OVERRIDE" value="DELETE"&gt;
</code></pre>

<p>Another solution is to send a <code>X_HTTP_METHOD_OVERRIDE</code> header.</p>
				</div>
			</div>
		</div>
	</div>


		</div>

		<footer>
			<div class="container">
				<div class="row">
					<div class="col l6 s12">
						<h5 class="white-text">Git</h5>
						<p class="grey-text lighten-4 github"></p>
						<p>
							<a href="https://travis-ci.org/mako-framework/framework">
								<img src="https://travis-ci.org/mako-framework/framework.svg?branch=master" alt="">
							</a>
						</p>
						<p>
							<a class="waves-effect waves-light btn grey darken-1" href="https://github.com/mako-framework/framework/issues">
								<span id="open-issues">?</span> Open Issues
							</a>
							<a class="waves-effect waves-light btn grey darken-1" href="https://github.com/mako-framework/framework/pulls">
								<span id="pull-requests">?</span> Pull Requests
							</a>
						</p>
					</div>
					<div class="col l4 offset-l2 s12">
						<h5 class="white-text">Links</h5>
						<ul>
							<li><a class="grey-text lighten-3" href="../../index.html">Home</a></li>
							<li><a class="grey-text lighten-3" href="../../changelog.html">Changelog</a></li>
							<li><a class="grey-text lighten-3" href="../4.html">Documentation</a></li>
							<li><a class="grey-text lighten-3" href="http://api.makoframework.com/">API</a></li>
							<li><a class="grey-text lighten-3" href="https://github.com/mako-framework/framework/issues">Issues</a></li>
							<li><a class="grey-text lighten-3" href="http://forum.makoframework.com/">Community</a></li>
						</ul>
					</div>
				</div>
			</div>
			<div class="footer-copyright">
				<div class="container">
					© 2015 Frederic G. Østby - All Rights Reserved
					<a class="grey-text lighten-4 right" href="https://twitter.com/makoframework">&nbsp;<i class="fa fa-twitter"></i></a>
					<a class="grey-text lighten-4 right" href="https://github.com/mako-framework">&nbsp;<i class="fa fa-github-alt"></i></a>
				</div>
			</div>
		</footer>

		<a href="#0" class="cd-top">Top</a>

		<script type="text/javascript" src="../../assets/js/jquery-2.1.1.min.js"></script>
		<script type="text/javascript" src="../../assets/js/jquery-ui.min.js"></script>
		<script type="text/javascript" src="../../assets/js/materialize.min.js"></script>
		<script type="text/javascript" src="../../assets/js/timeago.min.js"></script>
		<script type="text/javascript" src="../../assets/js/mako.js"></script>
		<script type="text/javascript" src="../../assets/js/prism.js"></script>
		<script type="text/javascript" src="../../assets/js/backtotop.js"></script>

	</body>

<!-- Mirrored from makoframework.com/docs/4.4/routing-and-controllers:routing by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 02 Aug 2015 15:42:32 GMT -->
</html>